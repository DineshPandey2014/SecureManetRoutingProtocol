/*
 * Intermediate node four.
 *
 * Node one sends the data to node three via node four.
 *
 * PORT of node four.
 * HOST of node four.
 *
 */
var PORT_OF_NODE_FOUR = 55555;
var HOST_NODE_FOUR = '127.0.0.1';

var dgram = require('dgram');
var server_node_four = dgram.createSocket('udp4');

server_node_four.on('listening', function () {
    var address = server_node_four.address();
    console.log('UDP Server listening on ' + address.address + ":" + address.port);
});

/*
 * Port of node three.
 * Host of node three.
 *
 */
var PORT_NODE_THREE = 44444;
var HOST_NODE_THREE = '127.0.0.1';
var client = dgram.createSocket('udp4');

server_node_four.on('message', function (message, remote) {
    console.log(remote.address + ':' + remote.port +' - ' + message);
    console.log("Node Four-->"+ message);
    message = "Hacked The Data";
    var nodeOne = new Buffer(message);
    console.log("Node Four After Buffer-->"+ nodeOne);
    client.send(nodeOne, 0, nodeOne.length, PORT_NODE_THREE, HOST_NODE_THREE, function(err, bytes) {
        if (err) throw err;
        console.log('UDP message sent to ' + HOST_NODE_THREE +':'+ PORT_NODE_THREE);
    });
});


server_node_four.bind(PORT_OF_NODE_FOUR, HOST_NODE_FOUR)

